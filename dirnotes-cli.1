.\" Automatically generated by Pandoc 2.17.1.1
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "dirnotes-cli" "1" "Sept 26, 2022" "dirnotes-cli 1.0" "User Manual"
.hy
.SH NAME
.PP
dirnotes-cli - view and manage Dirnotes file annotations
.SH SYNOPSIS
.PP
\ \ \ \ \f[B]dirnotes-cli\f[R] [-h] [\[en]help] [-V] [\[en]version]\ 
.PP
List:
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] [-v] [-j] [-l] [-d|-x]
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] [-v] [-j] [-n] [-d|-x] [filename]\&...
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] [-v] [-j] -H [filename]\&...
.PP
Create:
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] -c \[lq]comment\[rq] filename\&...
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] -a \[lq]comment\[rq] filename\&...
.PD 0
.P
.PD
\ \ \ \ \f[B]dirnotes-cli\f[R] -e filename\&...
.PP
FileCopy:
.PD 0
.P
.PD
\ \ \  \f[B]dirnotes-cli\f[R] -C [-y] src-file\&...
<dest-file | dest-dir>
.PD 0
.P
.PD
\ \ \  \f[B]dirnotes-cli\f[R] -M [-y] src-file\&...
<dest-file | dest-dir>
.PP
Cleanup:
.PD 0
.P
.PD
\ \ \  \f[B]dirnotes-cli\f[R] -z [filename]\&...
.PD 0
.P
.PD
\ \ \  \f[B]dirnotes-cli\f[R] -Z
.SH DESCRIPTION
.PP
The \f[B]dirnotes\f[R] family of apps allows you to add a descriptive
comment to a file.
The descriptions are stored in two places:
.IP \[bu] 2
in the xattr properties of the file
.IP \[bu] 2
in a database located in the user\[cq]s home directory
.PP
The \f[B]dirnotes-cli\f[R] is designed for use on the command line, or
in scripting.
.PP
The \f[I]list\f[R] commands will display the comment from the database
or xattr (as determined by the config file or as specified with
\f[B]-d\f[R]/\f[B]-x\f[R] options).
If the database and xattr comments differ, the comment will be
terminated by a `*' character.
The \f[B]-H\f[R] option displays the history of comments from the
database.
.PP
The output of the \f[I]list\f[R] commands can be in .json format
(\f[B]-j\f[R]) , and can optionally display the comment creator and the
comment date (\f[B]-v\f[R])
.PP
The \f[I]create\f[R] commands will attempt to store the file comments in
\f[I]both\f[R] the xattr of the file, and in the database.
If either of these fail, they fail silently.
Use the \f[B]-c\f[R] to create a comment, use \f[B]-a\f[R] to append to
an existing comment, and \f[B]-e\f[R] to erase a comment.
.PP
The \f[I]filecopy\f[R] commands will copy/move the file to a
destination, and preserve the file comments.
[See notes below about LIMITATIONS]
.PP
The \f[I]cleanup\f[R] commands can clean up the history of comments in
the database.
.SH LIMITATIONS
.PP
The file comments are located in two locations: a database, and in the
xattr properties of the file.
Each of these storage locations has its own benefits and limitations:
.SS xattr
.PP
Because \f[I]xattr\f[R] comments are bound to the filesystem, other
command line tools may be used to manage them.
Comments stored in the \f[I]xattr\f[R] properties can be copied/moved
with the file, if you use the correct options for \f[I]cp\f[R].
The \f[I]mv\f[R] utility automatically preserves \f[I]xattr\f[R].
Other programs can also be coerced into perserving \f[I]xattr\f[R]
properties:
.IP \[bu] 2
rsync
.IP \[bu] 2
tar
.IP \[bu] 2
mksquashfs
.PP
Not all file systems support \f[I]xattr\f[R] properties (vfat/exfat does
not).
.PP
The current implementation of \f[I]sshfs\f[R] and \f[I]scp\f[R] do not
support the copy of \f[I]xattr\f[R] properties.
If you want to copy files to a remote machine and include the
\f[I]xattr\f[R] comments, use \f[I]rsync\f[R] with the \f[I]-X\f[R]
option.
Or \f[I]tar\f[R] of course.
.PP
Some editing apps (like \f[I]vim\f[R]) will create a new file when
saving the data, which orphans the \f[I]xattr\f[R] comments.
For these apps, use the \f[I]database\f[R] system.
.PP
Of course, once you start to manipulate \f[I]xattr\f[R] comments outside
of the \f[B]dirnotes\f[R] programs, the \f[I]xattr\f[R] comments will
become out of sync with the \f[I]database\f[R] comments.
.SS database
.PP
Comments stored in the database work for all filesystem types (including
vfat/exfat/sshfs) Comments are usually stored in a \f[I]per user\f[R]
database; thus another user on the same system will not see these
comments.
.PP
Files are indexed by their complete path name.
Removable filesystems should be mounted in a consistent way, so that the
complete path name is reproducable.
.PP
If you are using \f[I]sshfs\f[R], you can use the \f[B]dirnotes\f[R]
programs to copy a file, and the database comments will work properly.
.PP
Comments stored in the database do not travel with the files when they
are moved or copied outside of using the \f[B]dirnotes\f[R]-family of
tools.
.SH OPTIONS
.TP
\f[B]-a\f[R]
append to a comment on a file
.TP
\f[B]-c\f[R]
add a comment to a file
.TP
\f[B]-C\f[R]
attempt to copy the file(s) and comments to a destination; if multiple
files are copied, the destination must be a directory; the last argument
is the destination
.TP
\f[B]-d\f[R]
use database comments as the primary source; cannot be used with
\f[B]-x\f[R]
.TP
\f[B]-D\f[R]
print debugging information
.TP
\f[B]-e\f[R]
erase the comments on the file(s)
.TP
\f[B]-h\f[R] \f[B]\[en]help\f[R]
display help and usage
.TP
\f[B]-H\f[R]
output the history of comments for the file(s)
.TP
\f[B]-j\f[R]
output (to stdout) the file comment in .json format
.TP
\f[B]-l\f[R]
list all files, including those without \f[I]dirnotes\f[R] comments
.TP
\f[B]-M\f[R]
move the file(s) and comments to the destination; if multiple files are
moved, the destination must be a directory
.TP
\f[B]-n\f[R]
output only the comment; this may be useful for scripting
.TP
\f[B]-v\f[R]
list full path names, also include the comment author and date in the
output
.TP
\f[B]-V\f[R] \f[B]\[en]version\f[R]
display version number
.TP
\f[B]-x\f[R]
use xattr comments as the primary source; connot be used with
\f[B]-d\f[R]
.TP
\f[B]-y\f[R]
allow file overwrite for \f[B]-C\f[R] copy or \f[B]-M\f[R] move
.TP
\f[B]-z\f[R]
erase history comments associated with the file(s); keep the current
comment
.TP
\f[B]-Z\f[R]
erase all the historic comments in the user\[cq]s database
.SH EXAMPLES
.PP
To display the comment for a file:
.RS
.PP
$ dirnotes-cli car_notes.txt
.PD 0
.P
.PD
car_notes.txt: `notes on the car repair'
.RE
.PP
To extract \f[I]only\f[R] the comment from a file, use the \f[I]-n\f[R]
option (useful for scripts):
.RS
.PP
$ dirnotes-cli -n car_notes.txt
.PD 0
.P
.PD
notes on the car repair
.RE
.PP
Or, in json format:
.RS
.PP
$ dirnotes-cli -j car_notes.txt
.PD 0
.P
.PD
[{\[lq]file\[rq]: \[lq]car_notes.txt\[rq], \[lq]comment\[rq]: \[lq]notes
on the car repair\[rq]}]
.RE
.PP
[NOTE: with json output, consider piping the results to jq for
pretty-print]
.PP
To append to a comment:
.RS
.PP
$ dirnotes-cli -a `first quote: $1,400' car_notes.txt
.PD 0
.P
.PD
$ dirnotes-cli car_notes.txt
.PD 0
.P
.PD
car_notes.txt: `notes on the car repair; first quote: $1,400'
.RE
.SH SEE ALSO
.PP
dirnotes, dirnotes-tui, dirnotes-cli
.PP
The \f[B]dirnotes\f[R] program provides a GUI for accessing the files
descriptions.
.PP
The \f[B]dirnotes-tui\f[R] program provides a \f[B]curses\f[R] based
(terminal) access to the descriptions.
.PP
The \f[B]dirnotes-cli\f[R] program provides command line access, and can
be scripted.
.SH CONFIGURATION FILE
.PP
By default, the file \f[B]\[ti]/.dirnotes.conf\f[R] will be used to load
the user\[cq]s config.
There are three attributes described in that file that are important:
.RS
.IP \[bu] 2
xattr_tag [default: user.xdg.comment]
.PD 0
.P
.PD
.IP \[bu] 2
database [default: \[ti]/.local/share/dirnotes/dirnotes.db]
.PD 0
.P
.PD
.IP \[bu] 2
start_mode [default: xattr]
.RE
.PP
The default location for the config file is
\[ti]/.config/dirnotes/dirnotes.conf
